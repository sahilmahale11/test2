openapi: 3.0.3
info:
  title: Enviate API - HUMAN INLOOP SERVICE
  description: |-
    Enviate offers a web application that streamlines the linkage between business/product needs and software development. By establishing an automated, bidirectional connection between requirements and software development, organizations can implement real-time checks to ensure that the software aligns with the specified requirements and that the requirements accurately mirror the present state of the code.
    This is a sample API with various endpoints for the HUMAN INLOOP SERVICE API to enable users to verify scores generated by the LLM model through human validation in API documentation.
  termsOfService: http://swagger.io/terms/
  contact:
    email: foo@enviate.com
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  version: 1.0.11
servers:
  - url: http://localhost/api/v1
tags:
  - name: confirmation
    description: The HUMAN INLOOP SERVICE API enables users to verify scores generated by the LLM model through human validation in API documentation.
paths:
  /confirmation/scores:
    get:
      tags:
        - confirmation
      summary: Fetch Top Link Score
      description: Retrieve the top link score.
      operationId: fetch_top_link_score
      responses:
        '200':
          description: Successful Response
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TopLinkInfo'
  
  /confirmation/scores/validate:
    post:
      tags:
        - confirmation
      summary: User Verify Link Score API
      description: API for users to verify the top link score for code and requirements.
      operationId: verify_link_score
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/VerificationInfo'
      responses:
        '200':
          description: Success
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidateResponseMessage'
  
  /confirmation/status/complete:
    post:
      tags:
        - confirmation
      summary: Set Linkage Status
      description: API to change linkage status after onboarding completion
      operationId: set_linkage_status
      responses:
        '200':
          description: Success
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LinkageResponseMessage'

components:
  schemas:
    CodeInfo:
      type: object
      properties:
        name:
          type: string
          description: Name of the code.
        contents:
          type: string
          description: Content of the code.
        file_path:
          type: string
          description: Name of the file containing the code.

    RequirementInfo:
      type: object
      properties:
        title:
          type: string
          description: Name of the requirement.
        description:
          type: string
          description: Description of the requirement.
        task_id:
          type: string
          description: ID of the task associated with the requirement.
    
    TopLinkInfo:
      type: object
      properties:
        top_link_id:
          type: integer
          description: ID of the top link.
        top_link_score:
          type: string
          description: Score of the top link
        code_info:
          $ref: '#/components/schemas/CodeInfo'
        requirement_info:
          $ref: '#/components/schemas/RequirementInfo'
        human_verification:
          type: string
          description: user validation input
        
    VerificationInfo:
      type: object
      properties:
        top_link_id:
          type: integer
          description: ID of the top link.
        human_verification:
          type: boolean
          description: Indicates whether the link was a pass or fail
    
    ValidateResponseMessage:
      type: object
      properties:
        message:
          type: string
          description: Response message.
        support_status:
          type: string
          description: Status if the repo will be supported or not 
        reason:
          type: string
          description: Reason of why it is unsupported
    
    LinkageResponseMessage:
      type: object
      properties:
        message:
          type: string
          description: Response message.
        linkage_status:
          type: string
          description: Linkage Status 
